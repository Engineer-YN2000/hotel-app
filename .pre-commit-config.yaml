# pre-commit フレームワーク (https://pre-commit.com/) の設定
repos:
  # ---------------------------------------------------
  # 1. 基本的な整形フック (pre-commit 標準)
  # ---------------------------------------------------
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace # 行末の不要なスペースを削除
      - id: end-of-file-fixer   # ファイル末尾の改行を修正
      - id: check-yaml          # YAML ファイルの構文チェック
      - id: check-json          # JSON ファイルの構文チェック

  # ---------------------------------------------------
  # 2. Prettier (フォーマッター)
  #    ローカル (frontend/) の npm スクリプト ('npm run format') を実行
  # ---------------------------------------------------
  - repo: local
    hooks:
      - id: prettier-format
        name: prettier-format
        language: system
        # frontend/package.json の 'format' スクリプトを実行
        entry: npm
        # モノレポ構成のため、frontend ディレクトリ内で実行する
        args: [run, format, --prefix, frontend]
        files: ^frontend/src/.*\.(js|jsx|css|json)$

  # ---------------------------------------------------
  # 3. ESLint (リンター)
  #    ローカル (frontend/) の npm スクリプト ('npm run lint:fix') を実行
  # ---------------------------------------------------
  - repo: local
    hooks:
      - id: eslint-lint-fix
        name: eslint-lint-fix
        language: system
        # frontend/package.json の 'lint:fix' スクリプトを実行
        entry: npm
        args: [run, lint:fix, --prefix, frontend]
        files: ^frontend/src/.*\.(js|jsx)$

  # ---------------------------------------------------
  # 4. Java フォーマッター (Spotless)
  #    'mvn spotless:apply' を実行
  # ---------------------------------------------------
  - repo: local
    hooks:
      - id: java-spotless-format
        name: java-spotless-format
        language: system
        # pom.xml で定義した spotless プラグインを実行
        entry: spotless:apply
        files: ^backend/src/main/java/.*\.(java)$
        # ビルド全体（target）を再実行しないよう 'process-sources' フェーズを指定
        args: [process-sources]

  # ---------------------------------------------------
  # 5. Java リンター (Checkstyle)
  #    'mvn checkstyle:check' を実行
  # ---------------------------------------------------
  - repo: local
    hooks:
      - id: java-checkstyle-lint
        name: java-checkstyle-lint
        language: system
        # pom.xml で定義した checkstyle プラグインを実行
        entry: checkstyle:check
        files: ^backend/src/main/java/.*\.(java)$
